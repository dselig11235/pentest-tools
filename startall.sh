#!/bin/bash

. ~/bin/target-functions.sh
. ~/bin/start-functions.sh
. vars
#nmapparser *.gnmap > nmap.parsed.txt
poptargets.py *.gnmap

#SSL targets
if test -e targets.ssl
    then sslstart
fi

#DNS targets
if test -e targets.dns
    then dnsstart
fi

#Ike targets
if test -e targets.ike
    then ikestart
fi

#NTP targets
if test -e targets.ntp
    then ntpstart
fi

#SMTP targets
if test -e targets.smtp
    then smtpstart
fi

#SIP targets
if test -e targets.sip
then
    sipstart
fi

#SNMP targets
if test -e targets.snmp
then 
    snmpstart
    snmpv3start
fi

for suf in http https; do
    if test -e targets.$suf; then
        for t in `cat targets.$suf`; do
            echo "$suf://"`gethost $t`:`getport $t` >> targets.web
        done
    fi
done
if test -e targets.web
    then webstart
fi

if test -e targets.unknown 
then 
    unknownstart
    cat targets.unknown >> targets.nc
fi
if test -e targets.nc
    then ncstart
fi

#manpassstart
#sshstart
#telnet-password-start
